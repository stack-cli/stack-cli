apiVersion: stack-cli.dev/v1
kind: StackApp
metadata:
  name: bionic-gpt
  namespace: bionic-gpt
spec:
  components:
    db:
    auth:
      hostname-url: https://inch-idol-controls-branches.trycloudflare.com/
    storage:
      install_minio: true
  services:
    web:
      image: ghcr.io/bionic-gpt/bionicgpt:1.11.59
      port: 7703
      database_url: APP_DATABASE_URL
      env:
        - name: DANGER_JWT_OVERRIDE
          value: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJnaXZlbl9uYW1lIjoiSWFuIiwiZW1haWwiOiJlbWFpbEBlbWFpbC5jb20iLCJmYW1pbGl5X25hbWUiOiJQdXJ0b24iLCJzdWIiOjEyMzR9.Yy-3FDWm70X9tQkzeO3CBQl-Sg2CZm2GBIKvS3zSj8U"
      init:
        image: ghcr.io/bionic-gpt/bionicgpt-db-migrations:1.11.59
        migrations_database_url: DATABASE_URL
        env:
          - name: INIT_MESSAGE
            value: "warming up"